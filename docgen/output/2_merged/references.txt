# References and IDs

## References and IDs

### Object References
-   **Reference Operator (`&`)**: Used to get a reference to an object by its ID.
    ```jac
    wlk = &walker_id;
    process = &process_id;
    ```
-   **`self`**: Refers to the walker object itself.
-   **`here`**: References the current node visited by the walker, enabling access to its attributes and callable abilities.
-   **`root`**: A unique, self-referential node reference for every Jac program invocation. Any other node or edge objects connected to `root` persist across code invocations, enabling persistent user state and data.

### Asynchronous Walker IDs
When an async walker is called, it returns immediately with a reference ID.
```json
{
  "status": 200,
  "walker_id": "w:sample:550e8400-e29b-41d4-a716-446655440000"
}
```
This `walker_id` can be used to retrieve the walker instance and its results.

```jac
walker view_sample_result {
    has walker_id: str;

    can enter with `root entry {
        // Get a reference to the walker instance
        wlk = &walker_id;

        // Access the walker's attributes
        print(wlk.value);

        // Check execution status and metadata
        schedule_info = wlk.__jac__.schedule;
        print(f"Status: {schedule_info.status}");
        print(f"Executed at: {schedule_info.executed_date}");

        // Check for errors
        if schedule_info.error{
            print(f"Error: {schedule_info.error}");
        }
    }
}
```

```jac
walker check_processing {
    has process_id: str;

    can enter with `root entry {
        process = &process_id;

        if process.__jac__.schedule.status == "COMPLETED"{
            print("Results:", process.results);
        }
        else{
            print("Still processing...");
        }
    }
}
```

## Imports

### Jac Import Patterns (`cl import`)
Jac provides a `cl import` syntax for interoperability with JavaScript/ECMAScript modules.

| Category | Jac Pattern | Notes |
|----------|---------------------|-------|
| **Named Imports** | `cl import from <module> { <name> }` <br> `cl import from <module> { <name1>, <name2> }` <br> `cl import from <module> { <name> as <alias> }` <br> `cl import from <module> { <name1>, <name2> as <alias2> }` | |
| **Relative Paths** | `cl import from .<path> { <name> }` (current directory) <br> `cl import from ..<path> { <name> }` (parent directory) <br> `cl import from ...<path> { <name> }` (grandparent directory, supports any number of dots) | |
| **Module Prefix** | `cl import from jac:<module> { <name> }` | `jac:` prefix is stripped for resolution. |
| **String Literal Imports** | `cl import from "<module-with-hyphens>" { <name> }` | Use string literals for package names with hyphens or special characters. |
| **Default Imports** | `cl import from <module> { default as <name> }` | Must use `cl` prefix. |
| **Namespace Imports** | `cl import from <module> { * as <name> }` | Must use `cl` prefix. |
| **Mixed Imports** | `cl import from <module> { default as <name>, <named_import> }` <br> `cl import from <module> { default as <name>, * as <namespace> }` | Order matters: default first. |
| **Named + Namespace Mix** | `cl import from <module> { * as <namespace>, <named_import> }` | Generates but produces **invalid JavaScript** - not recommended. |

#### Full Feature Demo
```jac
cl {
    // Named imports
    import from react { useState, useEffect, useRef }
    import from lodash { map as mapArray, filter }

    // Default imports
    import from react { default as React }
    import from axios { default as axios }

    // Namespace imports
    import from "date-fns" { * as DateFns }
    import from .utils { * as Utils }

    // String literal imports (for hyphenated packages)
    import from "react-dom" { render, hydrate }
    import from "styled-components" { default as styled }
    import from "react-router-dom" { BrowserRouter, Route }

    // Mixed imports
    import from react { default as React, useState, useEffect }

    // Relative paths
    import from .components.Button { default as Button }
    import from ..lib.helpers { formatDate }
    import from ...config.constants { API_URL }

    def MyComponent() {
        let [count, setCount] = useState(0);
        let now = DateFns.format(new Date());
        axios.get(API_URL);

        return count;
    }
}
```

### Python Imports (`import:py`)
Used for importing Python modules.
```jac
import:py from json {dumps};
```

## Standard Library

### `file` Module
-   `open(path: str) -> File`

### `json` Module
-   `dumps(obj: Any, *, skipkeys: bool = False, ensure_ascii: bool = True, check_circular: bool = True, allow_nan: bool = True, cls: type = None, indent: int | str = None, separators: tuple[str, str] | None = None, default: Callable = None, sort_keys: bool = False, **kw) -> str`
-   `loads(s: str | bytes | bytearray, *, cls: type = None, object_hook: Callable = None, parse_float: Callable = None, parse_int: Callable = None, parse_constant: Callable = None, object_pairs_hook: Callable = None, **kw) -> Any`

### `os` Module
(No specific functions provided in input, but `os` is a standard module.)

### `logging` Module
(No specific functions provided in input, but `logging` is a standard module.)

## Agent Patterns

### Agent Loops (`while` with `by llm()`)
(No specific examples provided in input, but "Agent Loops" using `while` with `by llm()` are a protected pattern.)

## Syntax & Keywords

### Type Annotations
-   `has x: type` for explicit type annotations.

### Node Properties
-   `.edges`: Accesses the edges connected to a node.

### Semantic String
-   `str "..."`: Defines a semantic string.

### Asynchronous Operations
-   `async`: Declares an asynchronous function.
-   `await`: Pauses execution until an asynchronous operation completes.

### Testing/Validation
-   `assert`: Used for asserting conditions, typically in tests.

### Persistence
-   `save`: Persists data.
-   `load`: Loads persisted data.

## CLI Tools

### `automate_ref`
Automates the generation of reference guides.
```bash
jac tool automate_ref
```