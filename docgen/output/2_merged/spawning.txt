# Spawning and Concurrency

## Spawning and Concurrency

### Spawning
Spawning allows for concurrent execution of operations.

-   **Spawning a single node:**
    ```jac
    spawn node_name;
    ```

-   **Spawning on a list of nodes:**
    ```jac
    spawn node_list;
    ```

-   **Spawning on a group of nodes:**
    ```jac
    spawn group_name;
    ```

-   **Spawning with arguments:**
    ```jac
    spawn node_name(arg1=value1, arg2=value2);
    ```

-   **Spawning and awaiting results:**
    ```jac
    async {
        result = await spawn node_name;
    }
    ```

### Asynchronous Operations
The `async` and `await` keywords are used for asynchronous programming.

-   **Defining an asynchronous block:**
    ```jac
    async {
        // Asynchronous operations here
    }
    ```

-   **Awaiting a spawned operation:**
    ```jac
    value = await spawn my_node;
    ```

### Agent Loops
Agents can run in continuous loops, often interacting with external models.

-   **Basic Agent Loop:**
    ```jac
    node Agent {
        has name: str;
        can start_loop {
            while (true) {
                // Agent logic here
                // Example: by llm() to interact with a language model
                // Example: await spawn another_agent;
            }
        }
    }
    ```

### Standard Library Modules

#### `file` Module
Provides functions for file system interaction.

-   `open(path: str, mode: str = "r") -> File`: Opens a file at the given `path` with the specified `mode`. Returns a `File` object.
    -   `mode`: "r" (read), "w" (write, truncates), "a" (append), "b" (binary).
-   `read(file_obj: File) -> str`: Reads the entire content of the `file_obj` as a string.
-   `write(file_obj: File, content: str)`: Writes the `content` string to the `file_obj`.

#### `os` Module
Provides functions for interacting with the operating system.

-   `getenv(key: str) -> str | None`: Returns the value of the environment variable `key`, or `None` if not set.
-   `setenv(key: str, value: str)`: Sets the environment variable `key` to `value`.
-   `remove(path: str)`: Removes (deletes) the file or empty directory at `path`.
-   `mkdir(path: str)`: Creates a directory at `path`.
-   `rmdir(path: str)`: Removes an empty directory at `path`.
-   `listdir(path: str) -> list[str]`: Returns a list of names of the entries in the directory given by `path`.

#### `json` Module
Provides functions for working with JSON data.

-   `import:py from json {dumps, loads};`
-   `dumps(obj: any, indent: int | None = None) -> str`: Serializes `obj` to a JSON formatted `str`.
    -   `indent`: If provided, pretty-prints JSON with the specified indentation level.
-   `loads(s: str) -> any`: Deserializes `s` (a JSON formatted `str`) to a Python object.

#### `logging` Module
Provides a flexible event logging system.

-   `import:py from logging {info, warning, error, debug};`
-   `info(msg: str)`: Logs an informational message.
-   `warning(msg: str)`: Logs a warning message.
-   `error(msg: str)`: Logs an error message.
-   `debug(msg: str)`: Logs a debug message.

### Persistence

-   **Saving a graph or node:**
    ```jac
    save graph_or_node_instance("path/to/file.jac");
    ```

-   **Loading a graph or node:**
    ```jac
    loaded_instance = load "path/to/file.jac";
    ```

### Type Annotations

-   **Explicit type annotation:**
    ```jac
    has my_variable: MyType;
    ```

### References

-   **Reference operator:**
    ```jac
    &my_variable
    ```

### Node Properties

-   **Accessing edges of a node:**
    ```jac
    my_node.edges
    ```

### Semantic Strings

-   **Defining a semantic string:**
    ```jac
    str "This is a semantic string."
    ```

### Testing and Validation

-   **Assertion:**
    ```jac
    assert condition, "Optional error message";
    ```

### Python Interoperability

-   **Importing Python modules/functions:**
    ```jac
    import:py module_name;
    import:py from module_name {function_name, ClassName};
    ```